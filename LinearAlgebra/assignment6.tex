\documentclass[11pt]{article}
\usepackage[T1]{fontenc}
\usepackage{geometry, changepage}
\usepackage{amsmath, amssymb, amsthm, bm}
\usepackage{physics}
\usepackage{hyperref}

\hypersetup{colorlinks=true, linkcolor=blue, urlcolor=cyan}
\setlength{\parindent}{0pt}
\setlength{\parskip}{5pt}

\newtheorem{theorem}{Theorem}
\newtheorem{lemma}{Lemma}
\newtheorem{claim}{Claim}
\newtheorem*{theorem*}{Theorem}
\newtheorem*{lemma*}{Lemma}
\newtheorem*{claim*}{Claim}

\renewcommand{\vec}[1]{\mathbf{#1}}
\newcommand{\uvec}[1]{\mathop{} \!\hat{\mathbf{#1}}}
\newcommand{\mat}[1]{\mathbf{#1}}
\newcommand{\tensor}[1]{\mathsf{#1}}

\renewcommand{\div}{\nabla \cdot}
\renewcommand{\curl}{\nabla \cross}
\renewcommand{\grad}{\nabla}
\renewcommand{\laplacian}{\nabla^{2}}

\title{MATH-UA 140: Assignment 6}
\author{James Pagan, November 2023}
\date{Professor Raqu√©pas}

% --------------------------------------------- %

\begin{document}

\maketitle
\tableofcontents

% --------------------------------------------- %

\section{Problem 1}

It is trivial to see that the column space of $A$ spans $\mathbb{R}^{2}$, and that the domain of $A$ is $\mathbb{R}^{4}$, so the nullity of $A$ is $2$ by the Fundamental Theorem of Linear Maps. Thus, observe that
\[
	\begin{bmatrix} 1 & 1 & 1 & 1 \\ -2 & -1 & 0 & 2 \end{bmatrix}\begin{bmatrix} 1 \\ -2 \\ 1 \\ 0 \end{bmatrix} = \begin{bmatrix} 1 - 2 + 1 + 0 \\ -2 + 2 + 0 + 0 \end{bmatrix} = \begin{bmatrix} 0 \\ 0 \end{bmatrix}
\]
and
\[
	\begin{bmatrix} 1 & 1 & 1 & 1 \\ -2 & -1 & 0 & 2 \end{bmatrix}\begin{bmatrix} 2 \\ -2 \\ -1 \\ 1 \end{bmatrix} = \begin{bmatrix} 2 - 2 - 1 + 1 \\ -4 + 2 + 0 + 2 \end{bmatrix} = \begin{bmatrix} 0 \\ 0 \end{bmatrix},
\]
Hence, the null space of $A$ is the column space of the matrix $T$ defined below:
\[
	T = \begin{bmatrix} 1 & 2 \\ -2 & -2 \\ 1 & -1 \\ 0 & 1 \end{bmatrix}
\]
The projection of $\vec{b}$ into the null space of $A$ is the projection of $\vec{b}$ into the column space of $T$. We now begin computing the projection matrix of $T$:
\[
	T^{\top} T = \begin{bmatrix} 1 & -2 & 1 & 0 \\ 2 & -2 & -1 & 1 \end{bmatrix} \begin{bmatrix} 1 & 2 \\ -2 & -2 \\ 1 & -1 \\ 0 & 1 \end{bmatrix} = \begin{bmatrix} 6 & 5 \\ 5 & 10 \end{bmatrix}.
\]
Now, observe that
\[
	\frac{1}{35} \begin{bmatrix} 10 & -5 \\ -5 & 6 \end{bmatrix} (T^{\top}T) = \frac{1}{35} \begin{bmatrix} 10 & -5 \\ -5 & 6 \end{bmatrix} \begin{bmatrix} 6 & 5 \\ 5 & 10 \end{bmatrix} = \frac{1}{35} \begin{bmatrix} 35 & 0 \\ 0 & 35 \end{bmatrix} = \begin{bmatrix} 1 & 0 \\ 0 & 1 \end{bmatrix}.
\]
and
\[
	(T^{\top}T) \frac{1}{35} \begin{bmatrix} 10 & -5 \\ -5 & 6 \end{bmatrix} = \frac{1}{35} \begin{bmatrix} 6 & 5 \\ 5 & 10 \end{bmatrix} \begin{bmatrix} 10 & -5 \\ -5 & 6 \end{bmatrix} = \frac{1}{35} \begin{bmatrix} 35 & 0 \\ 0 & 35 \end{bmatrix} = \begin{bmatrix} 1 & 0 \\ 0 & 1 \end{bmatrix}.
\]
Therefore,
\[
	\frac{1}{35} \begin{bmatrix} 10 & -5 \\ -5 & 6 \end{bmatrix} = (T^{\top}T)^{-1}
\]
Finally,
\begin{align*}
	T (T^{\top}T)^{1} T^{\top} &= \frac{1}{35} \begin{bmatrix}  1 & 2 \\ -2 & -2 \\ 1 & -1 \\ 0 & 1 \end{bmatrix} \begin{bmatrix} 10 & -5 \\ -5 & 6 \end{bmatrix} \begin{bmatrix} 1 & -2 & 1 & 0 \\ 2 & -2 & -1 & 1 \end{bmatrix} \\
	&= \frac{1}{35} \begin{bmatrix} 1 & 2 \\ -2 & -2 \\ 1 & -1 \\ 0 & 1 \end{bmatrix} \begin{bmatrix} 0 & -10 &  15 & -5 \\ 7 & -2 & -11 & 6 \end{bmatrix} \\
	&= \frac{1}{35} \begin{bmatrix} 14 & -14 & -7 & 7 \\ -14 & 24 & -8 & -2 \\ -7 & -8 & 26 & -11 \\ 7 & -2 & -11 & 6 \end{bmatrix}.
\end{align*}
We conclude that the projection we seek is
\[
	\frac{1}{35} \begin{bmatrix} 14 & -14 & -7 & 7 \\ -14 & 24 & -8 & -2 \\ -7 & -8 & 26 & -11 \\ 7 & -2 & -11 & 6 \end{bmatrix} \begin{bmatrix} 4 \\ 3 \\ 1 \\ 0 \end{bmatrix} = \boxed{\frac{1}{35} \begin{bmatrix} 7 \\ 8 \\ -26 \\ 11 \end{bmatrix}} 
\]

% --------------------------------------------- %

\section{Problem 2}

As $P$ and $Q$ are projection matricies, $P^{2} = P$ and $Q^{2} = Q$, so $P^{3} = P$; thus,
\begin{align*}
	PR &= P(P - Q)^{2} \\
	   &= P(P^{2} - PQ - QP + Q^{2}) \\
	   &= P^{3} - P^{2}Q - PQP + PQ^{2} \\
	   &= P - PQ - PQP + PQ \\
	   &= P - PQP \\
	   &= P - PQP - QP + QP \\
	   &= P^{3} - PQP - QP^{2} + Q^{2}P \\
	   &= (P^{2} - PQ - QP + Q^{2})P \\
	   &= (P - Q)^{2} P \\
	   &= RP.
\end{align*}

% --------------------------------------------- %

\section{Problem 3}

\textbf{Part (a)}: Observe that 

\begin{align*}
	P_{1} &= \vec{a}_{1} (\vec{a}_{1}^{\top}\vec{a}_{1})^{-1}\vec{a}_{1}^{\top} \\
	&= \frac{\vec{a}_{1}\vec{a}_{1}^{\top}}{\norm{\vec{a}_{1}}^{2}} \\
	&= \frac{1}{(-1)^{2} + 2^{2} + 2^{2}} \begin{bmatrix} -1 \\ 2 \\ 2 \end{bmatrix} \begin{bmatrix} -1 & 2 & 2 \end{bmatrix} \\
	&= \boxed{\frac{1}{9} \begin{bmatrix} 1 & -2 & -2 \\ -2 & 4 & 4 \\ -2 & 4 & 4 \end{bmatrix}}
\end{align*}
and
\begin{align*}
	P_{2} &= \vec{a}_{2} (\vec{a}_{2}^{\top}\vec{a}_{2})^{-1}\vec{a}_{2}^{\top} \\
	&= \frac{\vec{a}_{2}\vec{a}_{2}^{\top}}{\norm{\vec{a}_{2}}^{2}} \\
	&= \frac{1}{2^{2} + 2^{2} + (-1)^{2}} \begin{bmatrix} 2 \\ 2 \\ -1 \end{bmatrix} \begin{bmatrix} 2 & 2 & -1 \end{bmatrix} \\
	&= \boxed{\frac{1}{9} \begin{bmatrix} 4 & 4 & -2 \\ 4 & 4 & -2 \\ -2 & -2 & 1 \end{bmatrix}}.
\end{align*}
Multiplying these matricies, we find that
\[
	P_{1}P_{2} = \frac{1}{81} \begin{bmatrix} 1 & -2 & -2 \\ -2 & 4 & 4 \\ -2 & 4 & 4 \end{bmatrix} \begin{bmatrix} 4 & 4 & -2 \\ 4 & 4 & -2 \\ -2 & -2 & 1 \end{bmatrix} = \boxed{\begin{bmatrix} 0 & 0 & 0 \\ 0 & 0 & 0 \\ 0 & 0 & 0 \end{bmatrix}}.
\]
This makes intuitive sense if we recall that $\vec{a}_{1}$ and $\vec{a}_{2}$ are orthogonal. If we project all of 3-D space onto the span of $P_{1}$, then project that line to an orthogonal line in the direction of $P_{2}$, we should project $\mathbb{R}^{3}$ to the origin. 

\textbf{Part (b)}: We first need to calculate:
\begin{align*}
	P_{3} &= \vec{a}_{3} (\vec{a}_{3}^{\top}\vec{a}_{3})^{-1}\vec{a}_{3}^{\top} \\
	&= \frac{\vec{a}_{3}\vec{a}_{3}^{\top}}{\norm{\vec{a}_{3}}^{2}} \\
	&= \frac{1}{2^{2} + (-1)^{2} + 2^{2}} \begin{bmatrix} 2 \\ -1 \\ 2 \end{bmatrix} \begin{bmatrix} 2 & -1 & 2 \end{bmatrix} \\
	&= \boxed{\frac{1}{9} \begin{bmatrix} 4 & -2 & 4 \\ -2 & 1 & -2 \\ 4 & -2 & 4 \end{bmatrix}}.
\end{align*}
We now compute the three projection vectors $\vec{p}_{1}$, $\vec{p}_{2}$, and $\vec{p}_{3}$:
\begin{align*}
	\vec{p}_{1} = \frac{1}{9} \begin{bmatrix} 1 & -2 & -2 \\ -2 & 4 & 4 \\ -2 & 4 & 4 \end{bmatrix} \begin{bmatrix} 1 \\ 0 \\ 0 \end{bmatrix} = \boxed{\begin{bmatrix} \tfrac{1}{9} \\ -\tfrac{2}{9} \\ -\tfrac{2}{9} \end{bmatrix}} \\
	\vec{p}_{2} = \frac{1}{9} \begin{bmatrix} 4 & 4 & -2 \\ 4 & 4 & -2 \\ -2 & -2 & 1 \end{bmatrix} \begin{bmatrix} 1 \\ 0 \\ 0 \end{bmatrix} = \boxed{\begin{bmatrix} \tfrac{4}{9} \\ \tfrac{4}{9} \\ -\tfrac{2}{9} \end{bmatrix}} \\
	\vec{p}_{3} = \frac{1}{9} \begin{bmatrix} 4 & -2 & 4 \\ -2 & 1 & -2 \\ 4 & -2 & 4 \end{bmatrix} \begin{bmatrix} 1 \\ 0 \\ 0 \end{bmatrix} = \boxed{\begin{bmatrix} \tfrac{4}{9} \\ -\tfrac{2}{9} \\ \tfrac{4}{9} \end{bmatrix}}
\end{align*}
Adding these projections together, we find that
\[
	\vec{p}_{1} + \vec{p}_{2} + \vec{p}_{3} = \begin{bmatrix} \tfrac{1}{9} \\ -\tfrac{2}{9} \\ -\tfrac{2}{9} \end{bmatrix} + \begin{bmatrix} \tfrac{4}{9} \\ \tfrac{4}{9} \\ -\tfrac{2}{9} \end{bmatrix} + \begin{bmatrix} \tfrac{4}{9} \\ -\tfrac{2}{9} \\ \tfrac{4}{9} \end{bmatrix} = \begin{bmatrix} 1 \\ 0 \\ 0 \end{bmatrix} = \boxed{\vec{b}}.
\]
\textbf{Part (c)}: We have the following:
\begin{align*}
	P_{3} &= \vec{a}_{3} (\vec{a}_{3}^{\top}\vec{a}_{3})^{-1}\vec{a}_{3}^{\top} \\
	&= \frac{\vec{a}_{3}\vec{a}_{3}^{\top}}{\norm{\vec{a}_{3}}^{2}} \\
	&= \frac{1}{2^{2} + (-1)^{2} + 2^{2}} \begin{bmatrix} 2 \\ -1 \\ 2 \end{bmatrix} \begin{bmatrix} 2 & -1 & 2 \end{bmatrix} \\
	&= \boxed{\frac{1}{9} \begin{bmatrix} 4 & -2 & 4 \\ -2 & 1 & -2 \\ 4 & -2 & 4 \end{bmatrix}}.
\end{align*}
We now verify the following calculation:
\begin{align*}
	P_{1} + P_{2} + P_{3} &= \frac{1}{9} \left( \begin{bmatrix} 1 & -2 & -2 \\ -2 & 4 & 4 \\ -2 & 4 & 4 \end{bmatrix} + \begin{bmatrix} 4 & 4 & -2 \\ 4 & 4 & -2 \\ -2 & -2 & 1 \end{bmatrix} + \begin{bmatrix} 4 & -2 & 4 \\ -2 & 1 & -2 \\ 4 & -2 & 4 \end{bmatrix} \right) \\
	&= \frac{1}{9} \begin{bmatrix} 9 & 0 & 0 \\ 0 & 9 & 0 \\ 0 & 0 & 9 \end{bmatrix} = \begin{bmatrix} 1 & 0 & 0 \\ 0 & 1 & 0 \\ 0 & 0 & 1 \end{bmatrix} = I.
\end{align*}

% --------------------------------------------- %

\end{document}
